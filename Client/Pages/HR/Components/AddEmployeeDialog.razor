@using NCMS_wasm.Shared
<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">
            <MudIcon Icon="@Icons.Material.Filled.PersonAdd"></MudIcon>
            Add Employee
        </MudText>
    </TitleContent>
    <DialogContent>
        <MudForm @ref="form" Model="@employeeInfo">
            <MudStack Row>
                <MudItem xs="4">
                    <MudPaper Style="width: 192px; height: 192px;" Class="text-center" Elevation="0">
                        <MudImage Src="@employeeInfo.Profile" Height="192" Width="192" Class="pb-1" />
                        <MudFileUpload T="IBrowserFile" Accept=".png, .jpg, .jpeg" Class="" MaximumFileCount="1" FilesChanged="UploadFiles">
                            <ActivatorContent>
                                <MudFab HtmlTag="label"
                                        Size="MudBlazor.Size.Small"
                                        Color="MudBlazor.Color.Secondary"
                                        StartIcon="@Icons.Material.Filled.Image"
                                        Label="Select Image" />
                            </ActivatorContent>
                        </MudFileUpload>
                    </MudPaper>
                </MudItem>
                <MudItem xs="6">
                    <MudText Typo="Typo.caption">Personal Information</MudText>
                    <MudTextField @bind-Value="employeeInfo.Name" Label="Name" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.Address" Label="Address" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudStack Row>
                        <MudTextField @bind-Value="employeeInfo.Phone" Label="Phone" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                        <MudTextField @bind-Value="employeeInfo.Email" Label="Email" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    </MudStack>
                    <MudStack Row AlignItems="AlignItems.Baseline">
                        <MudText>Gender: </MudText>
                        <MudRadioGroup @bind-Value="employeeInfo.Gender">
                            <MudRadio Value="@("Male")" Color="Color.Success" Size="Size.Small">Male</MudRadio>
                            <MudRadio Value="@("Female")" Color="Color.Success" Size="Size.Small">Female</MudRadio>
                        </MudRadioGroup>
                    </MudStack>
                    <MudStack Row AlignItems="AlignItems.Baseline">
                        <MudText>Civil Status: </MudText>
                        <MudRadioGroup @bind-Value="employeeInfo.CivilStatus">
                            <MudRadio Value="@("Single")" Color="Color.Success" Size="Size.Small">Single</MudRadio>
                            <MudRadio Value="@("Married")" Color="Color.Success" Size="Size.Small">Married</MudRadio>
                            <MudRadio Value="@("Separated")" Color="Color.Success" Size="Size.Small">Separated</MudRadio>
                            <MudRadio Value="@("Widowed")" Color="Color.Success" Size="Size.Small">Widowed</MudRadio>
                        </MudRadioGroup>
                    </MudStack>

                    <MudTextField @bind-Value="employeeInfo.PlaceOfBirth" Label="Place of Birth" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudDatePicker Label="Date of Birth" Class="pt-1" Editable="true" Margin="Margin.Dense" @bind-Date="employeeInfo.DateOfBirth" Variant="Variant.Outlined" Placeholder="Select Date" />


                </MudItem>
            </MudStack>
            <MudDivider />
            <MudText Typo="Typo.caption">Employment Information</MudText>
            <MudStack Row>
                <MudItem xs="6">
                    <MudTextField @bind-Value="employeeInfo.EmploymentStatus" Label="Employment Status" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudDatePicker Class="pt-1" Label="Date Hired" Margin="Margin.Dense" Editable="true" Variant="Variant.Outlined" @bind-Date="employeeInfo.DateHired" Placeholder="Select Date" />
                    <MudTextField @bind-Value="employeeInfo.Position" Label="Position" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.Department" Label="Department" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.Salary" Label="Salary" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                </MudItem>
                <MudItem xs="6">
                    <MudTextField @bind-Value="employeeInfo.SSS" Label="SSS ID" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.PagIbig" Label="Pag-Ibig ID" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.PHIC" Label="PhilHealth ID" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                </MudItem>
            </MudStack>
            <MudDivider />
            <MudStack Row>
                <MudItem xs="6">
                    <MudText Typo="Typo.caption">Emergency Contact</MudText>
                    <MudTextField @bind-Value="employeeInfo.EmergencyContactName" Label="Name" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.EmergencyContactPhone" Label="Phone" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.EmergencyContactAddress" Label="Address" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.EmergencyContactRelationship" Label="Relationship" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                </MudItem>
                <MudItem xs="6">
                    <MudText Typo="Typo.caption">Beneficiary Information</MudText>
                    <MudTextField @bind-Value="employeeInfo.BeneficiaryName" Label="Name" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.BeneficiaryContactInfo" Label="Phone" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                    <MudTextField @bind-Value="employeeInfo.BeneficiaryRelationship" Label="Relationship" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
                </MudItem>
            </MudStack>


            @*  <MudTextField @bind-Value="events.EventName" Label="Holiday Description" ShrinkLabel Variant="Variant.Outlined"></MudTextField>
            <MudSelect T="string" @bind-Value="events.SubType" Label="Holiday Type" Variant="Variant.Outlined" AnchorOrigin="Origin.BottomCenter">
            <MudSelectItem Value="@("Regular Holiday")" />
            <MudSelectItem Value="@("Special Non-Working Holiday")" />
            </MudSelect>
            <MudStack Row>
            <MudDatePicker Label="From Date" @bind-Date="StartDate" />
            <MudDatePicker Label="To Date" @bind-Date="EndDate" />
            </MudStack>   *@
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudLoadingButton Variant="Variant.Filled"
                          Color="Color.Success"
                          Size="Size.Large"
                          Loading="@(_loading)"
                          OnClick="OnSubmit"
                          ButtonType="ButtonType.Button">
            <LoadingContent>Submitting...</LoadingContent>
            <ChildContent>Submit</ChildContent>
        </MudLoadingButton>
    </DialogActions>
</MudDialog>

@code {
    [Parameter] public Employee employeeInfo { get; set; }
    MudForm form;
    [CascadingParameter] MudDialogInstance? MudDialog { get; set; }
    [Inject] HttpClient? httpClient { get; set; }
    [Inject] ISnackbar Snackbar { get; set; }
    private bool _loading { get; set; }

    protected override async Task OnInitializedAsync()
    {

        await base.OnInitializedAsync();
    }

    void Cancel() => MudDialog.Cancel();


    private async Task OnSubmit()
    {
        await Task.CompletedTask;
    }

    private async Task UploadFiles(IBrowserFile file)
    {
        // try
        // {
        //     // Read the content of the file as a byte array
        //     using (var memoryStream = new MemoryStream())
        //     {
        //         await file.OpenReadStream(5120000).CopyToAsync(memoryStream); //Maximum file size is 5 mb
        //         var bytes = memoryStream.ToArray();

        //         // Convert the byte array to a base64 string
        //         var base64String = Convert.ToBase64String(bytes);
        //         store.Logo = base64String;
        //         // Construct the data URL
        //         imageUrl = $"data:{file.ContentType};base64,{base64String}";
        //     }
        // }
        // catch (Exception ex)
        // {
        //     Snackbar.Add("Maximum image file size is 5 MB", MudBlazor.Severity.Success);
        // }

    }

}